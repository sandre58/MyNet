<Project>

    <PropertyGroup>

        <!-- Enable analyzers during build -->
        <EnableNETAnalyzers>true</EnableNETAnalyzers>

        <!-- Enforce rules on all projects -->
        <AnalysisMode>AllEnabledByDefault</AnalysisMode>
        <AnalysisLevel>latest</AnalysisLevel>
        
        <!-- Ignore specific SDK warnings -->
        <NoWarn>$(NoWarn);SYSLIB0013;SYSLIB1054;CS1591;CS1574;NU5104;NETSDK1206;NETSDK1057</NoWarn>
        <SuppressNETCoreSdkPreviewMessage>true</SuppressNETCoreSdkPreviewMessage>

        <!-- Include code analysis in all configurations -->
        <EnforceCodeStyleInBuild>true</EnforceCodeStyleInBuild>
        <RunAnalyzersDuringBuild>true</RunAnalyzersDuringBuild>
        <RunAnalyzersDuringLiveAnalysis>true</RunAnalyzersDuringLiveAnalysis>
    </PropertyGroup>

    <!-- For forks (we want disable code analysis) -->
    <PropertyGroup Condition="'$(EnableNETAnalyzers)' != 'true'">
        <RunCodeAnalysis>Never</RunCodeAnalysis>
        <WarningLevel>0</WarningLevel>
        <NoWarn>$(NoWarn);CS0000-CS9999;IDE0000-IDE9999</NoWarn>
    </PropertyGroup>

    <!-- Analysis configuration files -->
    <ItemGroup Condition="'$(EnableNETAnalyzers)' == 'true'">
        <AdditionalFiles Include="$(SolutionDir)\stylecop.json" Link=".stylecop.json" Visible="False" />
    </ItemGroup>
    
    <!-- Add common analyzer packages -->
    <ItemGroup Condition="'$(EnableNETAnalyzers)' == 'true'">
        <!-- Analyzers Microsoft -->
        <PackageReference Include="Microsoft.CodeAnalysis.NetAnalyzers" Version="10.0.0-preview.25380.108" PrivateAssets="all" />
        <!-- StyleCop -->
        <PackageReference Include="StyleCop.Analyzers" Version="1.2.0-beta.556" PrivateAssets="all" />
        <!-- Roslynator -->
        <PackageReference Include="Roslynator.Analyzers" Version="4.14.0" PrivateAssets="all" />
    </ItemGroup>

</Project>